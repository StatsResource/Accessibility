<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistics with R</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistics with R
## Modelling Data with R - Linear Models

---





&lt;style type="text/css"&gt;
pre {
  background: #ADD8E6;
  max-width: 100%;
  overflow-x: scroll;
}
&lt;/style&gt;

In a study of the strength of pencil leads, standard length pieces of pencil lead 
were supported on two ends and loaded at their mid-points. Samples of five 
pieces each of 4H, H and B lead were used and the breaking stresses (load, in 
grams) at which each piece failed were recorded. The resulting data are given 
below. 



|         |     |     |     |      |     |
|:--------|:----|:----|:----|:-----|:----|
|4H lead: |56.7 |63.8 |56.7 |63.8  |49.6 |
|H lead:  |99.2 |99.2 |92.1 |106.0 |99.2 |
|B lead:  |56.7 |63.8 |70.9 |63.8  |70.9 |

---

### Creating the Data


```r
measurements &lt;- c(56.7 ,63.8 ,56.7 ,63.8 ,49.6 ,
                  99.2 ,99.2 ,92.1 ,106.0 ,99.2 ,
                  56.7 ,63.8 ,70.9 ,63.8, 70.9)

penciltypes &lt;- c( rep("4H",5), rep("H",5), rep("B",5))

class(penciltypes)
```

```
## [1] "character"
```


```r
penciltypes &lt;- factor(penciltypes, levels=c("4H","H","B"))

class(penciltypes)
```

```
## [1] "factor"
```


```r
myDF &lt;- data.frame(measurements,penciltypes)
```

---

### Exercise 1

Perform an analysis of variance on the above data and determine 
whether there are any differences between the population mean 
breaking stresses of 4H, H and B pencil lead. 

You are given that the assumptions hold for the analysis to be valid. 


---


```r
boxplot(measurements~ penciltypes, data= myDF)
```

![](RW-01023-RSS-HK_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;

---


```r
aov(measurements~ penciltypes, data= myDF)
```

```
## Call:
##    aov(formula = measurements ~ penciltypes, data = myDF)
## 
## Terms:
##                 penciltypes Residuals
## Sum of Squares     4806.028   378.928
## Deg. of Freedom           2        12
## 
## Residual standard error: 5.619371
## Estimated effects may be unbalanced
```

```r
# measurements and penciltypes exist as objects, so we dont need to specify the data set
```

Remark: measurements and penciltypes exist as objects, so we dont need to specify the data set


---


```r
myAOVmodel &lt;- aov(measurements~ penciltypes, data= myDF)
summary(myAOVmodel)
```

```
##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## penciltypes  2   4806  2403.0    76.1 1.52e-07 ***
## Residuals   12    379    31.6                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
---





```r
plot(myAOVmodel , which=1, pch=18,col="red",cex=2)
```

![](RW-01023-RSS-HK_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;
---


```r
plot(myAOVmodel, which=2, pch=18,col="red",cex=2)
```

![](RW-01023-RSS-HK_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;


---



### Exercise 3

* Carry out a post-hoc analysis to obtain confidence intervals for the pairwise differences between the population mean breaking stresses of the three types of pencil lead. * 

---
 
#### Post Hoc Tests 

After a multivariate test (ANOVA), it is often desired to know more about the specific groups to find out if they are significantly different or similar. This step after analysis is referred to as ‘post-hoc analysis’ and is a major step in hypothesis testing.

One common and popular method of post-hoc analysis is Tukey’s Test. The test is known by several different names. Tukey’s test compares the means of all treatments to the mean of every other treatment and is considered the best available method in cases when confidence intervals are desired or if sample sizes are unequal (Wikipedia).

---

The ***TukeyHSD()*** function is available in base R and takes a fitted ***aov*** object.


```r
tukey.test &lt;- TukeyHSD(myAOVmodel)
tukey.test
```

```
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = measurements ~ penciltypes, data = myDF)
## 
## $penciltypes
##        diff        lwr       upr     p adj
## H-4H  41.02  31.538406  50.50159 0.0000002
## B-4H   7.10  -2.381594  16.58159 0.1551368
## B-H  -33.92 -43.401594 -24.43841 0.0000017
```

---

### Conclusion

The output gives the difference in means, confidence levels and the adjusted p-values for all possible pairs. 

Note the pairings that do not contain 0 in the confidence intervals and thus, have significant difference. 

The confidence levels and p-values show significant between-group differences is for the pairings of ***4H v H*** and ***H vs B***, with no significant difference for the pairing ***4H vs B***.


The results can also be plotted.

---


```r
plot(tukey.test)
```

![](RW-01023-RSS-HK_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;

---


---

* HKSS HC2 - 2007 - Question 3
* https://hkss.org.hk/index.php/prof/exam/doc?highlight=WyJleGFtcyIsImV4YW0iXQ==

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
