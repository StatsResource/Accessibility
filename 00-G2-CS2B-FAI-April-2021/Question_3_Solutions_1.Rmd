Q3
(i)
mortalitydata =
read.csv(file = "CS2B_Apr_21_Qu_3_Data.csv", head = TRUE)
KMfit = 
survfit( 
 

Surv(mortalitydata$Time, mortalitydata$Status) ~ 1, 
 

conf.int = 0.995) 
 

plot( 
 

KMfit, 
 

xlab = "Time", 
 

ylab = "Survival Function, S(t)", 
 

main = "Kaplan-Meier Estimate, with its two-sided 99.5% 
confidence interval, for all patients") 
 


 

(ii)
summary(KMfit, time = 365)$surv
OR:
KMfit$surv[365]
OR:
min(KMfit$surv) 
 


 
 0.1715504 
 



The probability that a patient survived from the beginning of the investigation to the end of 
the investigation is 0.172 
 

(iii)
The probability value calculated in part (ii) is NOT suitable for assessing the effectiveness of 
MediCo 
 

as it is the average lifetime distribution of ALL patients in the investigation, whether they
received MediCo or not 
 

To review the effectiveness of MediCo we need to compare the lifetime distribution of 
patients that received the drug with the lifetime distribution of patients who did not 
 

(iv)
KMfit = 
survfit( 
 

Surv(mortalitydata$Time,mortalitydata$Status)
~Drug+Gender, [2½]
data = mortalitydata) 
 

print(KMfit)
Call: survfit(formula = Surv(mortalitydata$Time, 
mortalitydata$Status) ~ 
 Drug + Gender, data = mortalitydata)
N events median 0.95LCL 0.95UCL
Drug=0, Gender=0 1100 982 70 64 76
Drug=0, Gender=1 1100 870 145 135 158
Drug=1, Gender=0 1100 982 76 70 81
Drug=1, Gender=1 1100 607 295 273 317
OR:
KMfit = 
survfit( 
 

Surv(mortalitydata$Time,mortalitydata$Status)~ 
mortalitydata$Drug + mortalitydata$Gender) [3½]
print(KMfit)
Call: survfit(formula = Surv(mortalitydata$Time, 
mortalitydata$Status) ~ 
 mortalitydata$Drug + mortalitydata$Gender)
n events median
mortalitydata$Drug=0, mortalitydata$Gender=0 1100 982 70
mortalitydata$Drug=0, mortalitydata$Gender=1 1100 870 145
mortalitydata$Drug=1, mortalitydata$Gender=0 1100 982 76
mortalitydata$Drug=1, mortalitydata$Gender=1 1100 607 295
0.95LCL 0.95UCL
mortalitydata$Drug=0, mortalitydata$Gender=0 64 76
mortalitydata$Drug=0, mortalitydata$Gender=1 135 158
mortalitydata$Drug=1, mortalitydata$Gender=0 70 81


mortalitydata$Drug=1, mortalitydata$Gender=1 273 317
-----
plot( 
 

KMfit, 
 

xlab = "Time", 
 

ylab = "Survival Function, S(t)", 
 

main = "Kaplan-Meier Estimate for the four possible patient 
groups", 
 

col = c("blue", "red", "black", "green"), 
 

legend("topright", 
legend = c("Male - No Drug", "Female - No Drug", "Male -
Drug", "Female - Drug"), 
 

col = c("blue", "red", "black", "green"), 
 

pch = 7)

 

(v)
Female patients have a higher overall survival rate than male patients (with or without 
MediCo). 
 

MediCo seems to increase survival rates … 
 

… with the impact being much more significant on female lives than male lives. 
 

EITHER:
The impact of MediCo on male lives may not be statistically significant.


OR:
The impact of MediCo on male lives should be tested for statistical significance. 
 

The survival curves for males actually cross over a few times at later times, i.e. at certain 
points the raw estimates suggest the survival probabilities are higher for males not taking the 
drugs. However, this may be more reflective of a non-significant difference rather than 
MediCo actually reducing survival probabilities at these durations. 
 

[Marks available 5, maximum 3]
(vi)
coxph( 
 

Surv(mortalitydata$Time, mortalitydata$Status) ~ Drug + 
Gender, [1½]
data = mortalitydata, 
 

ties = "breslow") 
 

Call:
coxph(formula = Surv(mortalitydata$Time, mortalitydata$Status) 
~ 
 Drug + Gender, data = mortalitydata, ties = "breslow")
Coef exp(coef) se(coef) z p
Drug -0.35174 0.70347 0.03439 -10.23 <2e-16
Gender -0.93263 0.39352 0.03575 -26.09 <2e-16
Likelihood ratio test=820.3 on 2 df, p=< 2.2e-16
n= 4400, number of events= 3441 
 

OR:
coxph( 
 

Surv(mortalitydata$Time, mortalitydata$Status) ~ 
mortalitydata$Drug + mortalitydata$Gender, [2½]
ties = "breslow") 
 

Call:
coxph(formula = Surv(mortalitydata$Time, mortalitydata$Status) ~ 
 mortalitydata$Drug + mortalitydata$Gender, ties = "breslow")
 coef exp(coef) se(coef) z p
mortalitydata$Drug -0.35174 0.70347 0.03439 -10.23 <2e-16
mortalitydata$Gender -0.93263 0.39352 0.03575 -26.09 <2e-16
Likelihood ratio test=820.3 on 2 df, p=< 2.2e-16
n= 4400, number of events= 3441 
 



(vii)
The results suggest that MediCo reduces the mortality rate of patients by around 30% 
 

The results suggest that female lives’ mortality rates are around 40% of that of males 
 

However, the graphs from part (iv) suggest that an interaction term may be required in the 
Cox model to fully analyse the effects of MediCo and Gender on the mortality rate, and 
hence the above analysis is potentially misleading 
 

The results suggest that the Gender covariate appears to have a greater effect on the mortality 
rate than the Drug covariate 
 

Both p-values indicate that the coefficients are unlikely to be 0 
 

(viii)
coxph( 
 

Surv(mortalitydata$Time, mortalitydata$Status) ~ Drug*Gender, 

 

data = mortalitydata, 
 

ties = "breslow") 
 

Call:
coxph(formula = Surv(mortalitydata$Time, mortalitydata$Status) ~ 
 Drug * Gender, data = mortalitydata, ties = "breslow")
Coef exp(coef) se(coef) z p
Drug -0.07143 0.93106 0.04515 -1.582 0.114
Gender -0.63564 0.52960 0.04711 -13.494 <2e-16
Drug:Gender -0.65874 0.51750 0.06977 -9.442 <2e-16
Likelihood ratio test=910.2 on 3 df, p=< 2.2e-16
n= 4400, number of events= 3441 
 

OR:
coxph( 
 

Surv(mortalitydata$Time, mortalitydata$Status) ~ 
mortalitydata$Drug * mortalitydata$Gender, [1½]
ties = "breslow") 
 

Call:
coxph(formula = Surv(mortalitydata$Time, mortalitydata$Status) ~ 
 mortalitydata$Drug * mortalitydata$Gender, ties = "breslow")
 coef exp(coef) se(coef) z p
mortalitydata$Drug -0.07143 0.93106 0.04515 -1.582 0.114
mortalitydata$Gender -0.63564 0.52960 0.04711 -13.494 <2e-16
mortalitydata$Drug:mortalitydata$Gender -0.65874 0.51750 0.06977 -9.442 <2e-16
Likelihood ratio test=910.2 on 3 df, p=< 2.2e-16
n= 4400, number of events= 3441 
 



(ix)
MediCo reduces male mortality rates by 1 – 0.93106 = 6.9% 
 

which is not statistically significant 
 

and reduces female mortality rates by 1 – 0.93106 * 0.51750 = 51.8% 
 

which is statistically significant 
 

The results from the Cox analysis are consistent with the Kaplan–Meier plots in part (iv)

 

The likelihood ratio test statistic for the model with the interaction term compared with the 
model without the interaction term is: 
910.2 – 820.3 = 89.9 
OR 
L1 = m1$loglik
 

L2 = m2$loglik
 

-2 *(L1 - L2)

 
 89.8897
(where m1 = Cox model fitted in part (vi) and m2 = Cox model fitted in part (viii))
which is highly significant under the chi-squared distribution with one degree of freedom.

 

[Marks available 7, maximum5]
[Total 44]


[Paper Total 100]
END OF EXAMINERS’ REPORT
Part (i) was well answered, although some candidates showed 95% confidence 
intervals (the default) rather than 99.5% as specified in the question. Candidates are 
reminded to read the question carefully.
Part (ii) was well answered, although some candidates lost marks for not including 
their R output or for not stating their answer separately from the output.
Part (iii) was very poorly answered with most candidates not answering the question 
that was asked. The question asked candidates to evaluate the appropriateness of the 
probability value calculated in part (ii). The question was looking for an explanation 
that the probability value was not appropriate for assessing MediCo’s effectiveness 
and that further information was required.
Answers to part (iv) were generally satisfactory. However, instead of plotting a single 
survfit object, many candidates plotted separate survfit objects, on the same axes, for 
each of the four patient groups. These candidates tended to lose marks for one or 
more of the following reasons:
• Defining the patient groups incorrectly, e.g. conditioning on the Gender and 
Drug fields separately rather than together.
• Producing curves that terminated too early, as not all four patient groups had 
death or censoring events on the last day of the investigation.
• Including confidence intervals, which are excluded by default when a survfit 
object containing multiple survival curves is plotted.
Part (v) was very poorly answered although most candidates who produced the correct 
chart in part (iv) answered part (v) well.
Part (vi) was well answered although many candidates failed to specify the Breslow 
method for tie handling. This must be specified explicitly since the default method is 
the Efron method.
Part (vii) was very poorly answered. Few candidates quantified the impact of MediCo 
or gender on mortality rates. Very few candidates commented on the apparent need 
for an interaction term, which is a key conclusion from this analysis.
Part (viii) was well answered although many candidates used Drug + Gender + Drug 
* Gender in place of Drug * Gender, which was unnecessary because R automatically 
includes the first-order terms.
Part (ix) was very poorly answered. Many candidates commented on the statistical 
significance of gender in isolation, which was not relevant to this part of the question. 
Few candidates commented on the significance of the reduction in mortality from 
taking MediCo for each gender separately, or of the interaction term.
